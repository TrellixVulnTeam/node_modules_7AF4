import React from 'react';
import List from '../list';
import { render, fireEvent, cleanup } from '@testing-library/react';
import '@testing-library/jest-dom';

afterEach(cleanup);

const sample = [
    { id: 'id1', name: 'test1' },
    { id: 'id2', name: 'test2' },
    { id: 'id3', name: 'test3' },
    { id: 'id4', name: 'test4' },
];

it('renders correctly', async () => {
    const { getByTestId } = render(
        <List
            className='testClass'
            data={sample}
            renderItem={({ id, name }) => <div data-testid={id}>{name}</div>}
            collapsedSize={2}
        />,
    );

    const list = getByTestId('list');
    const moreButton = getByTestId('list-more');
    const expandedList = getByTestId('list-expand');
    const expandedChild = getByTestId('id3');

    expect(list).toHaveClass('met-list testClass');
    expect(expandedList).toContainElement(expandedChild);
    expect(expandedList).toHaveClass('met-list__expand--collapsed');

    fireEvent.click(moreButton);

    expect(expandedList).toHaveClass('met-list__expand--expanded');
});
